{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://diffusion-lighthouse.org/schema/papers.schema.json",
  "title": "Diffusion Lighthouse Papers Dataset",
  "type": "object",
  "required": ["papers"],
  "additionalProperties": false,
  "properties": {
    "papers": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/paper" }
    },
    "citations_meta": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "source": { "type": "string" },
        "snapshot_date": { "type": "string" },
        "last_updated_utc": { "type": "string" },
        "note": { "type": "string" },
        "notes": { "type": "string" }
      }
    }
  },
  "$defs": {
    "paper_id": {
      "type": "string",
      "pattern": "^[a-z0-9]+(?:_[a-z0-9]+)*$",
      "description": "Stable snake_case identifier (e.g., ddpm_2020)."
    },
    "paper": {
      "type": "object",
      "required": [
        "id",
        "title",
        "year",
        "authors",
        "venue",
        "links",
        "tags",
        "impact_type",
        "why_it_matters"
      ],
      "additionalProperties": false,
      "properties": {
        "id": { "$ref": "#/$defs/paper_id" },

        "title": { "type": "string", "minLength": 3 },

        "year": { "type": "integer", "minimum": 2010, "maximum": 2035 },

        "authors": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },

        "venue": { "type": "string", "minLength": 2 },

        "publication_status": {
          "type": "string",
          "description": "Peer-review status. 'canonical_preprint' is a rare exception.",
          "enum": [
            "accepted",
            "published",
            "canonical_preprint",
            "preprint",
            "submitted",
            "unknown"
          ]
        },

        "links": {
          "type": "object",
          "description": "Canonical links for the paper. For peer-reviewed entries, arXiv may be intentionally absent.",
          "additionalProperties": true,
          "properties": {
            "doi": { "type": "string", "format": "uri" },
            "journal": { "type": "string", "format": "uri" },
            "proceedings": { "type": "string", "format": "uri" },
            "publisher": { "type": "string", "format": "uri" },
            "official": { "type": "string", "format": "uri" },
            "url": { "type": "string", "format": "uri" },

            "arxiv": { "type": "string", "format": "uri" },
            "pdf": { "type": "string", "format": "uri" },

            "code": { "type": "string", "format": "uri" },
            "project": { "type": "string", "format": "uri" }
          }
        },

        "scholar": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "scholar_url": { "type": "string", "format": "uri" },
            "scholar_query": { "type": "string", "minLength": 1 },
            "cluster_id": { "type": "string" }
          }
        },

        "citations": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "count": { "type": ["integer", "string"] },
            "source": { "type": "string" },
            "snapshot_year": { "type": ["integer", "string"] },
            "snapshot_date": { "type": "string" },
            "scholar_cluster_id": { "type": "string" },
            "scholar_url": { "type": "string", "format": "uri" }
          }
        },

        "tags": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "pattern": "^[a-z0-9]+(?:-[a-z0-9]+)*$" }
        },
        "impact_type": {
          "type": "string",
          "enum": [
            "foundational",
            "enabling",
            "methodological",
            "refinement",
            "survey",
            "application",
            "benchmark",
            "system"
          ]
        },

        "dataset_focus": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        },

        "contribution_types": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        },

        "concept_tags": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        },

        "editorial_note": { "type": "string" },

        "relations": {
          "type": "array",
          "items": { "$ref": "#/$defs/relation" }
        },

        "why_it_matters": { "type": "string", "minLength": 20 }
      }
    },

    "relation": {
      "type": "object",
      "required": ["type"],
      "additionalProperties": false,
      "properties": {
        "type": { "type": "string", "minLength": 1 },

        "target_id": { "$ref": "#/$defs/paper_id" },
        "paper_id": { "$ref": "#/$defs/paper_id" },
        "target": { "$ref": "#/$defs/paper_id" },
        "id": { "$ref": "#/$defs/paper_id" },

        "target_title": { "type": "string" },
        "note": { "type": "string" }
      },
      "anyOf": [
        { "required": ["target_id"] },
        { "required": ["paper_id"] },
        { "required": ["target"] },
        { "required": ["id"] }
      ]
    }
  }
}
